datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum Role {
  CLIENTE
  TREINADOR
}

model Cliente {
  id              Int        @id @default(autoincrement())
  nome            String
  data_nascimento DateTime?
  peso            Float?
  altura          Float?
  objetivo        Objetivo?  @relation(fields: [id_objetivo], references: [id])
  id_objetivo     Int?
  status          Boolean    @default(true)
  data_cadastro   DateTime   @default(now())
  percent_gordura Float?
  percent_massa   Float?
  previsoes       Previsao[]
  treinador       Usuario?  @relation("TreinadorClientes", fields: [treinadorId], references: [id])
  treinadorId     Int?
  usuario         Usuario?  @relation("UserCliente")
}

model Objetivo {
  id            Int       @id @default(autoincrement())
  descricao     String
  data_cadastro DateTime  @default(now())
  clientes      Cliente[]
}

model Previsao {
  id            Int       @id @default(autoincrement())
  data_cadastro DateTime  @default(now())
  data_pesagem  DateTime
  cliente       Cliente   @relation(fields: [id_cliente], references: [id], onDelete: Cascade)
  id_cliente    Int
  peso_atual    Float?
  peso_previsto Float
}

model Usuario {
  id         Int      @id @default(autoincrement())
  nome       String
  email      String   @unique
  senha      String
  role       Role
  cliente    Cliente? @relation("UserCliente", fields: [clienteId], references: [id])
  clienteId  Int?     @unique
  clientes   Cliente[] @relation("TreinadorClientes")
}
